pipeline {
    agent any  // 使用任意可用节点

    stages {
        // 阶段1：清除代理配置 + 拉取代码
        stage('Checkout Code') {
            steps {
                bat 'git config --global --unset http.proxy || echo "No proxy to unset"'
                bat 'git config --global --unset https.proxy || echo "No proxy to unset"'
                checkout scm  // 自动拉取代码
            }
        }

        // 阶段2：运行测试（注意路径改为 jenkins_test/）
        stage('Run Hello Test') {
            steps {
                dir('jenkins_test') {  // 进入子目录
                    bat 'python hello_test.py'
                    bat 'dir /b'      // 验证文件列表
                }
            }
        }
    }

    post {
        always {
            echo '测试完成，请查看控制台输出'
        }
    }
}